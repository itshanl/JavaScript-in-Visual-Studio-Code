<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pop the Ballons</title>
  <style>
    :root{--bg:#0b1220;--panel:#0b1220;--accent:#099;--muted:#099}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Arial;background:linear-gradient(180deg,#071026 0%,#0b1220 100%);color:#e6eef6}
    .container{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .game{width:900px;max-width:100%;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.6);display:grid;grid-template-columns:260px 1fr;gap:12px}
    .panel{background:rgba(255,255,255,0.02);padding:14px;border-radius:8px}
    h1{margin:0 0 8px 0;font-size:18px}
    .stats{display:flex;flex-direction:column;gap:8px}
    .stat{display:flex;justify-content:space-between;padding:8px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);border-radius:6px}
    .play-area{position:relative;background:linear-gradient(180deg,#07172b,#081424);border-radius:8px;overflow:hidden;min-height:420px}
    .balloon{position:absolute;width:56px;height:72px;border-radius:30px 30px 26px 26px;display:flex;align-items:center;justify-content:center;font-weight:700;color:#0b1220;cursor:pointer;user-select:none}
    .balloon::after{content:'';position:absolute;bottom:-8px;left:50%;transform:translateX(-50%);width:4px;height:24px;background:rgba(255,255,255,0.15);border-radius:2px}
    .controls{display:flex;gap:8px;margin-top:8px}
    button{padding:8px 10px;border-radius:8px;border:0;background:var(--accent);color:white;cursor:pointer}
    button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .footer{font-size:12px;color:var(--muted);margin-top:10px}
    .center{display:flex;align-items:center;justify-content:center;height:100%}
    .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(2px)}
  </style>
</head>
<body>
  <div class="container">
    <div class="game" role="application" aria-label="Pop the Balloons game">
      <div class="panel" style="display:flex;flex-direction:column;">
        <h1>Pop the Balloons</h1>
        <p style="margin:0 0 12px 0;color:var(--muted);font-size:13px">Instructions: Tap balloons to pop them. Score as many as you can before the timer runs out. Balloons get faster over time.</p>

        <div class="stats">
          <div class="stat"><span>Score</span><strong id="score">0</strong></div>
          <div class="stat"><span>Time left</span><strong id="time">30</strong></div>
          <div class="stat"><span>Level</span><strong id="level">1</strong></div>
          <div class="stat"><span>High score</span><strong id="high">0</strong></div>
        </div>

        <div class="controls">
          <button id="startBtn">Start</button>
          <button id="resetBtn" class="secondary">Reset</button>
        </div>

        <div class="footer">Tips: The smaller balloons will give more points. Your high score is stored in this browser.</div>
      </div>

      <div class="play-area panel" id="playArea" tabindex="0" aria-label="Play area">
        <div class="center" id="welcome">
          <div style="text-align:center;color:var(--muted)">
            <h2 style="margin:0 0 6px 0">Ready?</h2>
            <p style="margin:0">Tap the Start to begin</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Simple Balloon Pop game
    const playArea = document.getElementById('playArea');
    const startBtn = document.getElementById('startBtn');
    const resetBtn = document.getElementById('resetBtn');
    const scoreEl = document.getElementById('score');
    const timeEl = document.getElementById('time');
    const levelEl = document.getElementById('level');
    const highEl = document.getElementById('high');
    const welcome = document.getElementById('welcome');

    let score = 0, timeLeft = 30, level = 1, high = 0;
    let running = false; let spawnTimer = null; let gameTimer = null; let speedFactor = 1;

    // load high score
    try { high = parseInt(localStorage.getItem('pop_high') || '0',10) || 0; } catch(e){ high = 0; }
    highEl.textContent = high;

    function random(min,max){ return Math.random()*(max-min)+min }

    function createBalloon(){
      const b = document.createElement('div');
      const size = Math.round(random(36,72));
      b.className = 'balloon';
      b.style.width = size+'px';
      b.style.height = Math.round(size*1.2)+'px';

      // color and points
      if(size < 46){ b.style.background = '#ffd166'; b.dataset.points = 5 }
      else if(size < 56){ b.style.background = '#06d6a0'; b.dataset.points = 3 }
      else { b.style.background = '#ff6b6b'; b.dataset.points = 1 }

      // starting position (bottom)
      const area = playArea.getBoundingClientRect();
      const x = random(8, area.width - size - 8);
      b.style.left = x+'px';
      b.style.bottom = '-80px';

      // random horizontal drift
      const drift = random(-30,30);

      // add pop handler
      b.addEventListener('click', (e)=>{
        if(!running) return;
        const pts = parseInt(b.dataset.points,10)||1;
        score += pts; scoreEl.textContent = score;
        popEffect(b, pts);
      });

      playArea.appendChild(b);

      // animate upward using requestAnimationFrame
      let y = -80; // px from bottom
      const speed = random(40,90) * speedFactor; // px per second
      const startTime = performance.now();

      function step(now){
        const dt = (now - startTime)/1000; // seconds since spawn
        // move up
        y = -80 + speed * dt;
        b.style.bottom = y + 'px';
        // small sideways oscillation
        b.style.transform = `translateX(${Math.sin(now/600 + drift)*8}px)`;
        if(y > area.height + 100){
          // remove off-screen
          b.remove();
          return;
        }
        requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }

    function popEffect(el, pts){
      // brief scale + fade
      el.style.transition = 'transform 200ms ease, opacity 200ms ease';
      el.style.transform = 'scale(1.4)';
      el.style.opacity = '0';
      // small floating text
      const fx = document.createElement('div');
      fx.textContent = '+'+pts;
      fx.style.position='absolute';
      fx.style.left = el.style.left;
      fx.style.bottom = (parseFloat(el.style.bottom) + 10) + 'px';
      fx.style.fontWeight='700';
      fx.style.pointerEvents='none';
      playArea.appendChild(fx);
      setTimeout(()=>{ fx.style.transition='all 700ms ease'; fx.style.bottom = (parseFloat(el.style.bottom)+80)+'px'; fx.style.opacity='0'; },10);
      setTimeout(()=>{ el.remove(); fx.remove(); },700);
    }

    function startGame(){
      if(running) return;
      running = true;
      score = 0; timeLeft = 30; level = 1; speedFactor = 1;
      scoreEl.textContent = score; timeEl.textContent = timeLeft; levelEl.textContent = level;
      welcome.style.display = 'none';

      // spawn balloons increasingly often
      spawnTimer = setInterval(()=>{
        // spawn 1-3 balloons
        const count = Math.random() < 0.6 ? 1 : 2;
        for(let i=0;i<count;i++) createBalloon();
      }, 900);

      // game timer
      gameTimer = setInterval(()=>{
        timeLeft -= 1; timeEl.textContent = timeLeft;
        // every 10s increase difficulty
        if((30 - timeLeft) % 10 === 0 && timeLeft !== 30){ level++; levelEl.textContent = level; speedFactor *= 1.2; clearInterval(spawnTimer);
          const newRate = Math.max(300, 900 - (level-1)*150);
          spawnTimer = setInterval(()=>{ const count = Math.random()<0.6?1:2; for(let i=0;i<count;i++) createBalloon(); }, newRate);
        }
        if(timeLeft <= 0){ endGame(); }
      },1000);
    }

    function endGame(){
      running = false;
      clearInterval(spawnTimer); clearInterval(gameTimer);
      spawnTimer = null; gameTimer = null;

      // clear remaining balloons
      Array.from(playArea.querySelectorAll('.balloon')).forEach(b=>b.remove());

      // update high score
      if(score > high){ high = score; highEl.textContent = high; try{ localStorage.setItem('pop_high', String(high)); }catch(e){}
        showOverlay(`NEW HIGH SCORE! ${score}`);
      } else showOverlay(`Time's up â€” Score ${score}`);
    }

    function resetGame(){
      running = false; clearInterval(spawnTimer); clearInterval(gameTimer); spawnTimer = null; gameTimer = null;
      score = 0; timeLeft = 30; level = 1; speedFactor = 1;
      scoreEl.textContent=score; timeEl.textContent=timeLeft; levelEl.textContent=level; welcome.style.display='flex';
      Array.from(playArea.querySelectorAll('.balloon')).forEach(b=>b.remove());
      removeOverlay();
    }

    function showOverlay(text){
      const ov = document.createElement('div'); ov.className='overlay';
      ov.innerHTML = `<div style="background:rgba(3,8,20,0.7);padding:18px;border-radius:12px;text-align:center;min-width:220px">`+
        `<h3 style="margin:0 0 6px 0">${text}</h3>`+
        `<div style="margin-top:8px;display:flex;gap:8px;justify-content:center">`+
        `<button id="playAgain">Play again</button>`+
        `<button id="close" class="secondary">Close</button>`+
        `</div></div>`;
      playArea.appendChild(ov);
      document.getElementById('playAgain').addEventListener('click', ()=>{ removeOverlay(); startGame(); });
      document.getElementById('close').addEventListener('click', removeOverlay);
    }
    function removeOverlay(){ const o = playArea.querySelector('.overlay'); if(o) o.remove(); }

    startBtn.addEventListener('click', ()=>{ removeOverlay(); startGame(); });
    resetBtn.addEventListener('click', resetGame);

    // accessibility: start with Enter in play area
    playArea.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') startGame(); });

    // small autoplay for demonstration: spawn a balloon now and then when idle
    setInterval(()=>{ if(!running && Math.random()<0.05){ createBalloon(); setTimeout(()=>{ Array.from(playArea.querySelectorAll('.balloon')).forEach(b=>b.remove()); },1500); } },1200);
  </script>
</body>
</html>
